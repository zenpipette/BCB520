{
  "hash": "058a5240c7813079ac55466518a880f0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 5 continued\"\nsubtitle: \"Hockey pain\"\nauthor: \"Sharon\"\ndate: \"2025-03-21\"\nformat: html\ncategories: [Assignment, DataViz]\nimage: ron.jpg\ncode-fold: true\ncode-tools: true\ndescrption: \"Summary of ballots\"\n---\n\n\n\nIn this continuation of Assignment 5, I will combine all the ballots from my classmates into 1 using a scoring system. If the player is ranked 1, they get 10 points. Rank 2 gets 7 points and so on like this:\n\nRank 1- 10 points\nRank 2- 7 points\nRank 3- 5 points\nRank 4- 3 points\nRank 5- 1 point\n\nThen we will see who has the highest score, and they will be on the final ballots.\n\nFirst all ballots need to be gathered, rearranged, and combined.\n\n\n\n\n\n\n\n\n\n\nObtain Sharon's ballot, which is the gold standard for formatting:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSharon <- readRDS(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/sharon_ballot.rds\")\nSharon |> mutate(Award = str_replace_all(Award, c(\"Frank Selke Memorial\" = \"Frank\", \n                                                  \"Calder Memorial\"=\"Calder\",\n                                                  \"Hart Memorial\"=\"Hart\",\n                                                  \"James Norris Memorial\" = \"James\",\n                                                  \"Lady Byng Memorial\"=\"Lady\"))) -> Sharon\n```\n:::\n\n\n\nObtain Barrie's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBarrie <- read_excel(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/Barrie.xlsx\")\n\nBarrie |>\n  mutate(Award = str_replace_all(Award, c(\"Selke\" = \"Frank\", \"Byng\" = \"Lady\", \"Norris\" = \"James\"))) -> Barrie\n```\n:::\n\n\n\nObtain Betsy's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nBetsy <- read_excel(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/BetsyChurchHockeyBallot.xlsx\")\nBetsy |> relocate(`Player Name`, .before=Name) |>\n  relocate(`Nomination position`, .before=Name) |>\n  rename(\n    Player = `Player Name`,\n    Rank = `Nomination position`,\n    Voter = Name\n  ) |>\n  mutate(Award = str_replace_all(Award, c(\"Selke\" = \"Frank\", \"Byng\" = \"Lady\", \"Norris\" = \"James\"))) -> Betsy\n```\n:::\n\n\n\nObtain Justice's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nJustice <- read_excel(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/Book 10.xlsx\")\nJustice |> fill(Award) |>\n  group_by(Award) %>%\n  mutate(Rank = rep(1:5, length.out = n()), Voter = \"Justice\") %>%\n  ungroup() |>\n  rename(Player = `Top 5 Individuals`) %>%\n  select(Player, Rank, Voter, Award) -> Justice\n\nJustice |> \n  mutate(Player=strsplit(as.character(Player), \"-\")) |>\n  unnest(Player) |>\n  mutate(Award = str_replace_all(Award, c(\"Hart Memorial\" = \"Hart\", \"Vezina Trophy\" = \"Vezina\", \n                                          \"James Norris Memorial\"= \"James\", \"Calder Memorial\"=\"Calder\", \n                                          \"Frank J Selke\"=\"Frank\"))) |>\n  filter(!is.na(Player)) -> Justice\n```\n:::\n\n\n\nObtain Marwa's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nMarwa <- read_excel(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/Book 11.xlsx\")\nMarwa |> mutate(Award = str_replace_all(Award, c(\"Hart Memorial Trophy\" = \"Hart\", \"Vezina Trophy\" = \"Vezina\", \n                                          \"James Norris Memorial Trophy\"= \"James\", \"Calder Memorial Trophy\"=\"Calder\", \n                                          \"Frank J. Selke Trophy\"=\"Frank\", \"Lady Byng Memorial Trophy\"=\"Lady\"))) -> Marwa\n```\n:::\n\n\n\nObtain Claire's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nClaire <- read.table(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/CS_ballot.txt\", header = TRUE, sep = \",\", stringsAsFactors = FALSE)\n\nClaire |> mutate(Award = str_replace_all(Award, c(\"Heart\" = \"Hart\", \n                                          \"James Norris\"= \"James\", \n                                          \"Frank J. Selke\"=\"Frank\", \"Lady Btng\"=\"Lady\"))) |>\n  select(Player, Rank, Voter, Award) -> Claire\n```\n:::\n\n\n\nObtain Ian's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIan <- read_excel(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/IAN HOCKEY NOMINATIONS.xlsx\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\n• `` -> `...3`\n```\n\n\n:::\n\n```{.r .cell-code}\nIan |> select(Voter, Trophy, Player) |>\n  group_by(Trophy) |>\n  mutate(Rank=row_number()) |>\n  ungroup() |>\n  mutate(Award = str_replace_all(Trophy, c(\"Hart Memorial\" = \"Hart\", \n                                          \"James Norris\"= \"James\", \"Calder Memorial\"=\"Calder\",\n                                          \"Frank J Selke\"=\"Frank\", \"Lady Byng\"=\"Lady\"))) |>\n  select(Player, Rank, Voter, Award) -> Ian\n```\n:::\n\n\n\nObtain John's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nJohn <- read.table(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/JohnCam.txt\", header = TRUE, sep = \",\", stringsAsFactors = FALSE)\n\nJohn |> mutate(Voter=\"John\") |> \n  mutate(Award = str_replace_all(Award, c(\"James Norris\"= \"James\",\n                                          \"Frank J. Selke\"=\"Frank\", \"Lady Bing\"=\"Lady\"))) |>\n  rename(Rank = Place) |>\n  select(Player, Rank, Voter, Award) -> John\n```\n:::\n\n\n\nObtain Henry's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nHenry <- read_excel(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/NHL award ballot HT.xlsx\")\nHenry |> mutate(Award = str_replace_all(Award, c(\"James Norris\"= \"James\",\n                                          \"Frank J. Selke\"=\"Frank\", \"Lady Byng\"=\"Lady\"))) |>\n  mutate(Voter = ifelse(Voter == \"Henry Trujillo\", \"Henry\", Voter)) -> Henry\n```\n:::\n\n\n\nObtain Priya's ballot and adjust.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPriya <- read_excel(\"C:/Users/sharo/Desktop/BCB 520/BCB520/posts/Mar_20_ballots/NHL_Award_ballet.xlsx\")\nPriya %>%\n  pivot_longer(cols = -c(Voters, Rank), names_to = \"Award\", values_to = \"Player\") %>%\n  mutate(Voters = ifelse(Voters == \"'\\\"'\", \"Priya\", Voters)) |>\n  mutate(Voter=\"Priya\") |> select(-Voters) |>\n  mutate(Award = str_replace_all(Award, c(\"VEZINA\"= \"Vezina\",\n                                          \"HART\"=\"Hart\",\n                                          \"JAMES NORRIS\"=\"James\",\n                                          \"CALDER\"=\"Calder\",\n                                          \"FRANK J SELKE\"=\"Frank\",\n                                          \"LADY BING\"=\"Lady\"))) |>\n  select(Player, Rank, Voter, Award) -> Priya\n```\n:::\n\n\n\nEveryone's combined ballots (head only)\n\n\n::: {.cell}\n\n```{.r .cell-code}\neveryone <- rbind(Barrie, Sharon, Betsy, Claire, Henry, Ian, John, Justice, Marwa, Priya)\n\neveryone |>\n  mutate(Player = str_squish(Player)) %>%\n  mutate(Player = ifelse(str_detect(Player, \" \"), \n                         word(Player, -1), \n                         Player)) |>\n  mutate(Player = ifelse(Player == \"Caufieldn\", \"Caufield\", Player)) |>\n  mutate(Player = ifelse(str_detect(Player, \"^Go\"), \"Gostisbeher\", Player)) -> everyone\nhead(everyone)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 4\n  Voter  Award  Player      Rank\n  <chr>  <chr>  <chr>      <dbl>\n1 Barrie Hart   Hughes         1\n2 Barrie Hart   Werenski       2\n3 Barrie Hart   Makar          3\n4 Barrie Hart   Draisaitl      4\n5 Barrie Hart   Kucherov       5\n6 Barrie Vezina Hellebuyck     1\n```\n\n\n:::\n:::\n\n\n\nThe final scores (head only)\n\n\n::: {.cell}\n\n```{.r .cell-code}\neveryone |>mutate(Score = case_when(\n    Rank == 5 ~ 1,\n    Rank == 4 ~ 3,\n    Rank == 3 ~ 5,\n    Rank == 2 ~ 7,\n    Rank == 1 ~ 10,\n    TRUE ~ 0  # default case if Rank is not 1-5\n  )) |> \n  group_by(Award, Player)|>\n  summarise(sum(Score)) -> finalscore\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`summarise()` has grouped output by 'Award'. You can override using the\n`.groups` argument.\n```\n\n\n:::\n\n```{.r .cell-code}\nhead(finalscore)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n# Groups:   Award [1]\n  Award  Player     `sum(Score)`\n  <chr>  <chr>             <dbl>\n1 Calder Bolduc                7\n2 Calder Brink                10\n3 Calder Clurman              10\n4 Calder Cooley                6\n5 Calder Cotter                1\n6 Calder Crookshank            5\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfinalscore <- finalscore %>%\n  rename(sumscore = `sum(Score)`)\n```\n:::\n\n\n\nCreate final ballots for each award\n\nI acknowledge ties in the scores and choose not to do anything about them.\n\nCalder Memorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinalscore |> filter(Award==\"Calder\") |>\n  arrange(desc(sumscore)) |>\n  slice_head(n=5) |>\n  mutate(Rank=row_number()) -> final_ballot_calder\n\nfinal_ballot_calder\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n# Groups:   Award [1]\n  Award  Player    sumscore  Rank\n  <chr>  <chr>        <dbl> <int>\n1 Calder Marchenko       55     1\n2 Calder Johnston        45     2\n3 Calder Rossi           24     3\n4 Calder Holloway        16     4\n5 Calder Johnson         12     5\n```\n\n\n:::\n:::\n\n\n\nFrank Selke\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinalscore |> filter(Award==\"Frank\") |>\n  arrange(desc(sumscore)) |>\n  slice_head(n=5) |>\n  mutate(Rank=row_number()) -> final_ballot_Frank\n\nfinal_ballot_Frank\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n# Groups:   Award [1]\n  Award Player     sumscore  Rank\n  <chr> <chr>         <dbl> <int>\n1 Frank Tanev            20     1\n2 Frank Blake            17     2\n3 Frank MacKinnon        15     3\n4 Frank Tuch             14     4\n5 Frank Zetterlund       14     5\n```\n\n\n:::\n:::\n\n\nHart Memorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinalscore |> filter(Award==\"Hart\") |>\n  arrange(desc(sumscore)) |>\n  slice_head(n=5) |>\n  mutate(Rank=row_number()) -> final_ballot_hart\n\nfinal_ballot_hart\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n# Groups:   Award [1]\n  Award Player      sumscore  Rank\n  <chr> <chr>          <dbl> <int>\n1 Hart  Draisaitl         38     1\n2 Hart  MacKinnon         22     2\n3 Hart  Gostisbeher       21     3\n4 Hart  Kucherov          21     4\n5 Hart  Werenski          14     5\n```\n\n\n:::\n:::\n\n\n\nJames Norris\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinalscore |> filter(Award==\"James\") |>\n  arrange(desc(sumscore)) |>\n  slice_head(n=5) |>\n  mutate(Rank=row_number()) -> final_ballot_James\n\nfinal_ballot_James\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n# Groups:   Award [1]\n  Award Player   sumscore  Rank\n  <chr> <chr>       <dbl> <int>\n1 James Makar          21     1\n2 James Hughes         20     2\n3 James Cole           18     3\n4 James Werenski       15     4\n5 James Bouchard       13     5\n```\n\n\n:::\n:::\n\n\nLady Byng\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinalscore |> filter(Award==\"Lady\") |>\n  arrange(desc(sumscore)) |>\n  slice_head(n=5) |>\n  mutate(Rank=row_number()) -> final_ballot_lady\n\nfinal_ballot_lady\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n# Groups:   Award [1]\n  Award Player   sumscore  Rank\n  <chr> <chr>       <dbl> <int>\n1 Lady  Point          25     1\n2 Lady  Karlsson       21     2\n3 Lady  Makar          20     3\n4 Lady  Eichel         14     4\n5 Lady  Connor         10     5\n```\n\n\n:::\n:::\n\n\nVezina memorial\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinalscore |> filter(Award==\"Vezina\") |>\n  arrange(desc(sumscore)) |>\n  slice_head(n=5) |>\n  mutate(Rank=row_number()) -> final_ballot_vezina\n\nfinal_ballot_vezina\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 4\n# Groups:   Award [1]\n  Award  Player      sumscore  Rank\n  <chr>  <chr>          <dbl> <int>\n1 Vezina Hellebuyck        90     1\n2 Vezina Vasilevskiy       57     2\n3 Vezina Thompson          28     3\n4 Vezina Blackwood         19     4\n5 Vezina Wolf              12     5\n```\n\n\n:::\n:::\n\n\n\nI am going to rename Frank to Selke, James to Norris, and Lady to Byng because I don't know why I chose the first names. Last names sound better.\n\nHere is the final compiled ballot:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_ballot <- rbind(final_ballot_calder, final_ballot_Frank, final_ballot_hart, final_ballot_James, \n                      final_ballot_lady, final_ballot_vezina)\n\nfinal_ballot <- final_ballot |> \n  mutate(Award = case_when(\n    Award == \"Frank\" ~ \"Selke\",\n    Award == \"James\" ~ \"Norris\",\n    Award == \"Lady\" ~ \"Byng\",\n    TRUE ~ Award  # Keep other entries unchanged\n  ))\n\nsaveRDS(final_ballot, file=\"Sharon_final_ballot_combined.rds\")\n\nprint(final_ballot)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 30 × 4\n# Groups:   Award [6]\n   Award  Player     sumscore  Rank\n   <chr>  <chr>         <dbl> <int>\n 1 Calder Marchenko        55     1\n 2 Calder Johnston         45     2\n 3 Calder Rossi            24     3\n 4 Calder Holloway         16     4\n 5 Calder Johnson          12     5\n 6 Selke  Tanev            20     1\n 7 Selke  Blake            17     2\n 8 Selke  MacKinnon        15     3\n 9 Selke  Tuch             14     4\n10 Selke  Zetterlund       14     5\n# ℹ 20 more rows\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}